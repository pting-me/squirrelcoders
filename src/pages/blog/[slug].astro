---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Bio from '../../components/Bio.astro';
import getPostData from '../../utils/getPostData';
import getSlug from '../../utils/getSlug';
import '../../styles/blog-post.css';

export async function getStaticPaths() {
  const posts = await Astro.glob('../../data/blog-posts/*.md');
  return posts.map((p) => ({
    params: { slug: getSlug(p.file) },
    props: { post: p },
  }));
}

const { Content, frontmatter } = Astro.props.post;
const { title, description, publishDate } = frontmatter;
const localePublishDate = new Date(publishDate).toLocaleDateString(undefined, {
  dateStyle: 'long',
});
const { slug, readingTime } = getPostData(Astro.props.post);
const permalink = `${Astro.site?.href}${slug}`;
---

<BaseLayout
  title={title}
  description={description}
  permalink={permalink}
  current="blog"
>
  <header class="text-center">
    <p
      class="uppercase font-sans font-semibold text-stone-600 dark:text-stone-300"
    >
      {localePublishDate} ~ {readingTime}
    </p>
    <h1 class="mt-6 mb-4 text-4xl">{title}</h1>
    <hr class="min-w-min w-1/3 mx-auto my-10" />
  </header>
  <div class="my-0 mx-auto max-w-2xl w-full">
    <article class="blog-post--content">
      <Content />
    </article>
    <hr />
    <Bio />
  </div>
</BaseLayout>
